!function(t,e,i,n){"use strict";function s(e,i){this.element=e;var n={};t.each(t(this.element).data(),function(t,e){var i=function(t){return t&&t[0].toLowerCase()+t.slice(1)},s=i(t.replace("fluidbox",""));(""!==s||null!==s)&&(e="false"==e?!1:!0,n[s]=e)}),this.settings=t.extend({},r,i,n),this.settings.viewportFill=Math.max(Math.min(parseFloat(this.settings.viewportFill),1),0),this.settings.stackIndex<this.settings.stackIndexDelta&&(settings.stackIndexDelta=settings.stackIndex),this._name=o,this.init()}var a=t(e),o=(t(i),"fluidbox"),r={immediateOpen:!1,loader:!1,maxWidth:0,maxHeight:0,resizeThrottle:500,stackIndex:1e3,stackIndexDelta:10,viewportFill:.95},d={},l=0;t.isFunction(t.throttle)||console.warn("Fluidbox: The jQuery debounce/throttle plugin is not found/loaded. Even though Fluidbox works without it, the window resize event will fire extremely rapidly in browsers, resulting in significant degradation in performance upon viewport resize.");var f=function(){var t,e=i.createElement("fakeelement"),s={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in s)if(e.style[t]!==n)return s[t]},c=f(),u={dom:function(){var e=t("<div />",{"class":"fluidbox__wrap",css:{zIndex:this.settings.stackIndex-this.settings.stackIndexDelta}});if(t(this.element).addClass("fluidbox--closed").wrapInner(e).find("img").first().css({opacity:1}).addClass("fluidbox__thumb").after('<div class="fluidbox__ghost" />'),this.settings.loader){var i=t("<div />",{"class":"fluidbox__loader",css:{zIndex:2}});t(this.element).find(".fluidbox__wrap").append(i)}},prepareFb:function(){var e=this,i=t(this.element);i.trigger("thumbloaddone.fluidbox"),u.measure.fbElements.call(this),e.bindEvents(),i.addClass("fluidbox--ready"),e.bindListeners(),i.trigger("ready.fluidbox")},measure:{viewport:function(){d.viewport={w:a.width(),h:a.height()}},fbElements:function(){var e=this,i=t(this.element),n=i.find("img").first(),s=i.find(".fluidbox__ghost"),a=i.find(".fluidbox__wrap");e.instanceData.thumb={natW:n[0].naturalWidth,natH:n[0].naturalHeight,w:n.width(),h:n.height()},s.css({width:n.width(),height:n.height(),top:n.offset().top-a.offset().top+parseInt(n.css("borderTopWidth"))+parseInt(n.css("paddingTop")),left:n.offset().left-a.offset().left+parseInt(n.css("borderLeftWidth"))+parseInt(n.css("paddingLeft"))})}}};t.extend(s.prototype,{init:function(){var e=this,i=t(this.element),n=i.find("img").first();if(u.measure.viewport(),(!e.instanceData||!e.instanceData.initialized)&&i.is("a")&&1===i.children().length&&(i.children().is("img")||i.children().is("picture")&&1===i.find("img").length)&&"none"!==i.css("display")&&"none"!==i.children().css("display")&&"none"!==i.parents().css("display")){i.removeClass("fluidbox--destroyed"),e.instanceData={},e.instanceData.initialized=!0,e.instanceData.originalNode=i.html(),l+=1,e.instanceData.id=l,i.addClass("fluidbox__instance-"+l),i.addClass("fluidbox--initialized"),u.dom.call(e),i.trigger("init.fluidbox");var s=new Image;n.width()>0&&n.height()>0?u.prepareFb.call(e):(s.onload=function(){u.prepareFb.call(e)},s.onerror=function(){i.trigger("thumbloadfail.fluidbox")},s.src=n.attr("src"))}},open:function(){var e=this,i=t(this.element),n=i.find("img").first(),s=i.find(".fluidbox__ghost"),a=i.find(".fluidbox__wrap");s.off(c),t(".fluidbox--opened").fluidbox("close");var o=t("<div />",{"class":"fluidbox__overlay",css:{zIndex:-1}});a.append(o),i.removeClass("fluidbox--closed").addClass("fluidbox--loading"),s.css({"background-image":"url("+n.attr("src")+")",opacity:1}),u.measure.fbElements.call(e);var r;e.settings.immediateOpen?(i.addClass("fluidbox--opened fluidbox--loaded").find(".fluidbox__wrap").css({zIndex:e.settings.stackIndex+e.settings.stackIndexDelta}),i.trigger("openstart.fluidbox"),e.compute(),n.css({opacity:0}),t(".fluidbox__overlay").css({opacity:1}),s.one(c,function(){i.trigger("openend.fluidbox")}),r=new Image,r.onload=function(){1===e.instanceData.state&&(e.instanceData.thumb.natW=r.naturalWidth,e.instanceData.thumb.natH=r.naturalHeight,i.removeClass("fluidbox--loading"),s.css({"background-image":"url("+r.src+")"}),e.compute())},r.onerror=function(){e.close(),i.trigger("imageloadfail.fluidbox"),i.trigger("delayedloadfail.fluidbox")},r.src=i.attr("href")):(r=new Image,r.onload=function(){i.removeClass("fluidbox--loading").addClass("fluidbox--opened fluidbox--loaded").find(".fluidbox__wrap").css({zIndex:e.settings.stackIndex+e.settings.stackIndexDelta}),i.trigger("openstart.fluidbox"),s.css({"background-image":"url("+r.src+")"}),e.instanceData.thumb.natW=r.naturalWidth,e.instanceData.thumb.natH=r.naturalHeight,e.compute(),n.css({opacity:0}),t(".fluidbox__overlay").css({opacity:1}),s.one(c,function(){i.trigger("openend.fluidbox")})},r.onerror=function(){e.close(),i.trigger("imageloadfail.fluidbox")},r.src=i.attr("href"))},compute:function(){var e=this,i=t(this.element),n=i.find("img").first(),s=i.find(".fluidbox__ghost"),o=i.find(".fluidbox__wrap"),r=e.instanceData.thumb.natW,l=e.instanceData.thumb.natH,f=e.instanceData.thumb.w,c=e.instanceData.thumb.h,u=r/l,h=d.viewport.w/d.viewport.h;e.settings.maxWidth>0?(r=e.settings.maxWidth,l=r/u):e.settings.maxHeight>0&&(l=e.settings.maxHeight,r=l*u);var p,g,b,x,m;h>u?(p=l<d.viewport.h?l:d.viewport.h*e.settings.viewportFill,b=p/c,x=r*(c*b/l)/f,m=b):(g=r<d.viewport.w?r:d.viewport.w*e.settings.viewportFill,x=g/f,b=l*(f*x/r)/c,m=x),e.settings.maxWidth&&e.settings.maxHeight&&console.warn("Fluidbox: Both maxHeight and maxWidth are specified. You can only specify one. If both are specified, only the maxWidth property will be respected. This will not generate any error, but may cause unexpected sizing behavior.");var v=a.scrollTop()-n.offset().top+.5*(c*(m-1))+.5*(a.height()-c*m),w=.5*(f*(m-1))+.5*(a.width()-f*m)-n.offset().left,_=parseInt(100*x)/100+","+parseInt(100*b)/100;s.css({transform:"translate("+parseInt(100*w)/100+"px,"+parseInt(100*v)/100+"px) scale("+_+")",top:n.offset().top-o.offset().top,left:n.offset().left-o.offset().left}),i.find(".fluidbox__loader").css({transform:"translate("+parseInt(100*w)/100+"px,"+parseInt(100*v)/100+"px) scale("+_+")"}),i.trigger("computeend.fluidbox")},recompute:function(){this.compute()},close:function(){var e=this,i=t(this.element),n=i.find("img").first(),s=i.find(".fluidbox__ghost"),a=i.find(".fluidbox__wrap"),o=i.find(".fluidbox__overlay");i.trigger("closestart.fluidbox"),i.removeClass(function(t,e){return(e.match(/(^|\s)fluidbox--[opened|loaded|loading]+/g)||[]).join(" ")}).addClass("fluidbox--closed"),s.css({transform:"translate(0,0) scale(1,1)",top:n.offset().top-a.offset().top+parseInt(n.css("borderTopWidth"))+parseInt(n.css("paddingTop")),left:n.offset().left-a.offset().left+parseInt(n.css("borderLeftWidth"))+parseInt(n.css("paddingLeft"))}),i.find(".fluidbox__loader").css({transform:"none"}),s.one(c,function(){s.css({opacity:0}),n.css({opacity:1}),o.remove(),a.css({zIndex:e.settings.stackIndex-e.settings.stackIndexDelta}),i.trigger("closeend.fluidbox")}),o.css({opacity:0})},bindEvents:function(){var e=this,i=t(this.element);i.on("click.fluidbox",function(t){t.preventDefault(),e.instanceData.state&&0!==e.instanceData.state?(e.instanceData.state=0,e.close()):(e.instanceData.state=1,e.open())})},bindListeners:function(){var e=this,i=t(this.element),n=function(){u.measure.viewport(),u.measure.fbElements.call(e),i.hasClass("fluidbox--opened")&&e.compute()};t.isFunction(t.throttle)?a.on("resize.fluidbox"+e.instanceData.id,t.throttle(e.settings.resizeThrottle,n)):a.on("resize.fluidbox"+e.instanceData.id,n),i.on("reposition.fluidbox",function(){e.reposition()}),i.on("recompute.fluidbox, compute.fluidbox",function(){e.compute()}),i.on("destroy.fluidbox",function(){e.destroy()}),i.on("close.fluidbox",function(){e.close()})},unbind:function(){t(this.element).off("click.fluidbox, reposition.fluidbox, recompute.fluidbox, compute.fluidbox, destroy.fluidbox, close.fluidbox"),a.off("resize.fluidbox"+this.instanceData.id)},reposition:function(){u.measure.fbElements.call(this)},destroy:function(){var e=this.instanceData.originalNode;this.unbind(),t.data(this.element,"plugin_"+o,null),t(this.element).removeClass(function(t,e){return(e.match(/(^|\s)fluidbox[--|__]\S+/g)||[]).join(" ")}).empty().html(e).addClass("fluidbox--destroyed").trigger("destroyed.fluidbox")},getMetadata:function(){return this.instanceData}}),t.fn[o]=function(e){var i=arguments;if(e===n||"object"==typeof e)return this.each(function(){t.data(this,"plugin_"+o)||t.data(this,"plugin_"+o,new s(this,e))});if("string"==typeof e&&"_"!==e[0]&&"init"!==e){var a;return this.each(function(){var n=t.data(this,"plugin_"+o);n instanceof s&&"function"==typeof n[e]?a=n[e].apply(n,Array.prototype.slice.call(i,1)):console.warn('Fluidbox: The method "'+e+'" used is not defined in Fluidbox. Please make sure you are calling the correct public method.')}),a!==n?a:this}return this}}(jQuery,window,document);